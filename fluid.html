<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluid Typography - Chicken Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@900&display=swap');

        body {
            margin: 0;
            padding: 0;
            background-color: #111;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            cursor: none; /* 隐藏系统光标 */
            user-select: none;
        }

        canvas {
            display: block;
        }

        /* --- 自定义光标容器 --- */
        #cursor-container {
            position: absolute;
            top: 0; left: 0;
            width: 40px; height: 40px;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 100;
            mix-blend-mode: difference; /* 关键：反色效果 */
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.1s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* 跟随的平滑度 */
        }

        /* 状态1：圆环 (默认) */
        .cursor-ring {
            width: 100%;
            height: 100%;
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            transition: all 0.2s ease;
            position: absolute;
            opacity: 1;
        }

        /* 状态2：鸡爪 (默认隐藏) */
        .cursor-claw {
            width: 120%; /* 鸡爪稍微大一点才霸气 */
            height: 120%;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.1s cubic-bezier(0.68, -0.55, 0.265, 1.55); /* 弹性弹出动画 */
            fill: white;
            position: absolute;
        }

        /* --- 点击激活状态 (.active) --- */
        
        /* 圆环消失 */
        #cursor-container.active .cursor-ring {
            opacity: 0;
            transform: scale(0.5);
            border-color: transparent;
        }

        /* 鸡爪出现 */
        #cursor-container.active .cursor-claw {
            opacity: 1;
            transform: scale(1) rotate(-15deg); /* 稍微歪一点，像抓下去的动作 */
        }

        /* 整个光标容器在点击时稍微下沉 */
        #cursor-container.active {
            width: 50px; /* 尺寸略微放大 */
            height: 50px;
        }

    </style>
</head>
<body>

    <!-- 自定义光标组件 -->
    <div id="cursor-container">
        <div class="cursor-ring"></div>
        <!-- 纯手写 SVG 鸡爪图标 -->
        <svg class="cursor-claw" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
            <path d="M512 672c-19.2 0-38.4-9.6-48-28.8l-128-256c-19.2-38.4-3.2-86.4 35.2-105.6s86.4-3.2 105.6 35.2L512 387.2l35.2-70.4c19.2-38.4 67.2-54.4 105.6-35.2s54.4 67.2 35.2 105.6l-128 256c-9.6 19.2-28.8 28.8-48 28.8z" />
            <path d="M512 864c-35.2 0-64-28.8-64-64V480c0-35.2 28.8-64 64-64s64 28.8 64 64v320c0 35.2-28.8 64-64 64z" />
            <path d="M320 736c-12.8 0-25.6-3.2-38.4-12.8-32-22.4-38.4-67.2-16-99.2l96-128c22.4-32 67.2-38.4 99.2-16s38.4 67.2 16 99.2l-96 128c-12.8 19.2-35.2 28.8-60.8 28.8z" />
            <path d="M704 736c-25.6 0-48-9.6-60.8-28.8l-96-128c-22.4-32-16-76.8 16-99.2s76.8-16 99.2 16l96 128c22.4 32 16 76.8-16 99.2-12.8 9.6-25.6 12.8-38.4 12.8z" />
        </svg>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const cursorContainer = document.getElementById('cursor-container');
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let particles = [];
        let mouse = { x: null, y: null, radius: 40 }; // 斥力半径
        
        // 词库配置
        const wordList = ["USTC", "MAN!", "鸡你太美", "唱跳RAP"];
        let wordIndex = 0;

        // === 1. 光标逻辑优化 ===
        window.addEventListener('mousemove', (e) => {
            mouse.x = e.clientX;
            mouse.y = e.clientY;
            
            // 使用 transform 移动，性能更好
            cursorContainer.style.left = e.clientX + 'px';
            cursorContainer.style.top = e.clientY + 'px';
        });

        // 鼠标按下：激活“鸡爪”模式
        window.addEventListener('mousedown', () => {
            cursorContainer.classList.add('active');
        });

        // 鼠标松开：恢复“圆环”模式，并切换文字
        window.addEventListener('mouseup', () => {
            cursorContainer.classList.remove('active');
            
            // 切换词汇
            wordIndex = (wordIndex + 1) % wordList.length;
            init(wordList[wordIndex]);
        });

        // 窗口调整
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            init(wordList[wordIndex]);
        });


        // === 2. 粒子物理系统 (保持原有优秀手感) ===
        class Particle {
            constructor(x, y) {
                this.x = Math.random() * canvas.width; 
                this.y = Math.random() * canvas.height;
                this.targetX = x;
                this.targetY = y;
                // 粒子尺寸微调
                this.size = Math.random() * 2 + 1; 
                
                this.vx = 0; 
                this.vy = 0;
                this.density = (Math.random() * 30) + 1; 
                this.friction = 0.85; // 稍微调高一点摩擦力，让文字复原更稳重
                this.ease = 0.03; 
            }

            draw() {
                const speed = Math.abs(this.vx) + Math.abs(this.vy);
                const alpha = 1 - Math.min(speed * 0.05, 0.7);
                
                ctx.fillStyle = `rgba(255, 255, 255, ${alpha})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }

            update() {
                let dx = this.targetX - this.x;
                let dy = this.targetY - this.y;
                
                this.vx += dx * this.ease;
                this.vy += dy * this.ease;

                if (mouse.x != null) {
                    let mouseDx = mouse.x - this.x;
                    let mouseDy = mouse.y - this.y;
                    let distance = Math.sqrt(mouseDx * mouseDx + mouseDy * mouseDy);

                    // 斥力逻辑
                    if (distance < mouse.radius) {
                        const forceDirectionX = mouseDx / distance;
                        const forceDirectionY = mouseDy / distance;
                        const force = (mouse.radius - distance) / mouse.radius;
                        
                        // 当鼠标按下时(active)，斥力可以稍微变大一点，模拟抓散的效果
                        const extraPower = cursorContainer.classList.contains('active') ? 5 : 1;

                        const directionX = forceDirectionX * force * this.density * extraPower;
                        const directionY = forceDirectionY * force * this.density * extraPower;

                        this.vx -= directionX;
                        this.vy -= directionY;
                    }
                }

                this.vx *= this.friction;
                this.vy *= this.friction;

                this.x += this.vx;
                this.y += this.vy;
            }
        }

        // === 3. 文本处理 ===
        function init(text) {
            particles = [];
            let fontSize = Math.min(canvas.width / 5, 200);
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = `900 ${fontSize}px Inter, sans-serif`;
            ctx.fillStyle = 'white';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(text, canvas.width / 2, canvas.height / 2);

            const textCoordinates = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const step = 6; // 采样步长，越小粒子越密
            
            for (let y = 0; y < textCoordinates.height; y += step) {
                for (let x = 0; x < textCoordinates.width; x += step) {
                    const index = (y * 4 * textCoordinates.width) + (x * 4) + 3;
                    if (textCoordinates.data[index] > 128) {
                        particles.push(new Particle(x, y));
                    }
                }
            }
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particles.length; i++) {
                particles[i].draw();
                particles[i].update();
            }
            requestAnimationFrame(animate);
        }

        init(wordList[0]);
        animate();

        // 移出窗口清理坐标
        window.addEventListener('mouseout', () => {
            mouse.x = undefined;
            mouse.y = undefined;
        })

    </script>
</body>
</html>